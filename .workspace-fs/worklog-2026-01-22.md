### Worklog (2026-01-22)

#### Added dependencies
- `better-auth`
- `drizzle-orm`
- `drizzle-kit` (migration base only; operational procedure not set up yet)
- `@libsql/client` (Turso connection)
- `@vercel/sandbox` (Vercel Sandbox SDK)

#### Added major modules
- **DB connection**: `lib/db.ts` (`DATABASE_URL` / `DATABASE_AUTH_TOKEN`)
- **Auth**: `lib/auth.ts`, `lib/auth-client.ts`, `lib/auth-utils.ts`
  - Next.js handler: `app/api/auth/[...all]/route.ts`
- **App schema (temporary)**: `lib/schema/*`
  - `agents`, `conversations`, `messages`, `sandbox_instances`
- **Sandbox management (minimal)**: `lib/sandbox/manager.ts`

#### Added APIs (Route Handlers)
- **Agents**
  - `GET /api/agents`
  - `POST /api/agents`
  - `GET /api/agents/:id`
- **Conversations**
  - `GET /api/conversations`
  - `POST /api/conversations` (start new conversation = create sandbox + save sandboxId in DB)
  - `GET /api/conversations/:id`
  - `GET /api/conversations/:id/messages`
  - `POST /api/conversations/:id/messages` (execute input via `bash -lc` in sandbox -> save to messages)
  - `POST /api/conversations/:id/archive` (stop sandbox + archive)

#### UI (minimal)
- Landing: `app/page.tsx` (logged out -> sign-in/up, logged in -> `/app`)
- Auth: `app/(auth)/sign-in`, `app/(auth)/sign-up`
- App: `app/(app)/layout.tsx`, `app/(app)/app/page.tsx` (/app)

#### Not done / known gaps
- **DB migrations not set up**
  - BetterAuth table creation (BetterAuth CLI, etc.)
  - App table creation (Drizzle Kit, etc.)
- **No sandbox artifact persistence** (by design; archived is chat history only)
- **Input = shell execution** is MVP only; future tooling/limits are required

#### Addendum (2026-01-22)
- Standardized DB env var names from `TURSO_*` to `DATABASE_URL` / `DATABASE_AUTH_TOKEN` (updated implementation, README, and `.workspace-fs`)

